\documentclass{article}

\usepackage[a4paper]{geometry}
\usepackage{amsmath,amsfonts,amssymb,amsthm}
\usepackage{enumerate}
\usepackage{comment}
\usepackage{dsfont}
\usepackage{tikz}
\usetikzlibrary{matrix}
\newcommand{\ing}[1]{$\vcenter{\hbox{\includegraphics[width=20mm]{#1}}}$}
\tikzset{
  % style for inserting images as nodes
  img/.style={
    text width=20mm,
    inner sep=0pt,
    outer sep=0pt,
    rectangle,
    align=center}
}

\newtheorem{propo}{Proposition}
\newtheorem{lemma}[propo]{Lemma}

\DeclareMathOperator{\Real}{Re}
\DeclareMathOperator{\Imag}{Im}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\spn}{span}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\meas}{meas}

\begin{document}
\title{Orthonormal subsets of the Legendre-Haar quarklet system}
\author{Thorsten Raasch}
\maketitle

\begin{abstract}
The Legendre-Haar quarklet system is a set of piecewise polynomial and globally discontinous functions on the real line with cancellation properties. As we show in this paper, the Legendre-Haar quarklet system not only contains the Haar wavelet basis and the $L_2$-normalized truncated Legendre polynomials as orthonormal subsystems, but also a variety of other orthonormal bases which are piecewise polynomial with respect to a nonuniform partition of $\mathbb R$ into dyadic subintervals.
\end{abstract}

\section{Orthogonality properties of Legendre-Haar quarklets}
\subsection{Legendre-Haar quarklets}
Let us first define the Legendre-Haar quarklet system. To this end, for $p\in\mathbb N_0$, let $L_p$ be the $p$-th orthogonal Legendre polynomial on $[-1,1]$ with normalization $L_p(1)=1$. It is well-known that
\begin{equation*}
\int_0^1 L_p(x)L_q(x)\,\mathrm dx=\begin{cases}
\frac{2}{2p+1},&p=q,\\
0,&p\ne q,
\end{cases}
\end{equation*}
so that the truncated and renormalized Legendre polynomials
\begin{equation}
  \label{eq:phip}
  \varphi_p(x):=\sqrt{2p+1}L_p(2x-1)\chi_{[0,1)}(x),\quad
  p\in\mathbb N_0,\quad x\in\mathbb R,
\end{equation}
induce the orthonormal basis
\begin{equation*}
\big\{\varphi_p(\cdot-k):p\in\mathbb N_0,k\in\mathbb Z\big\}
\end{equation*}
for $L_2(\mathbb R)$. Let us call the functions $\varphi_p$ \emph{Legendre-Haar quarks}, which is motivated by the combination of Legendre polynomials $L_p$ and the Haar scaling function $\chi_{[0,1)}$. 

Furthermore, let us define the \emph{Legendre-Haar quarklets}
\begin{equation}
  \label{eq:psip}
  \psi_p(x):=\varphi_p(2x)-\varphi_p(2x-1),\quad
  p\in\mathbb N_0,\quad x\in\mathbb R,
\end{equation}
which is a generalization of the two-scale relation $\psi_0(x)=\varphi_0(2x)-\varphi_0(2x-1)$ of Haar wavelets. The \emph{Legendre-Haar quarklet system} is then given as the set
\begin{equation}
\label{eq:Psi}
\Psi:=\big\{\varphi_p(\cdot -k):p\in\mathbb N_0,k\in\mathbb Z\big\}\cup\big\{\psi_{p,j,k}:=2^{j/2}\psi_p(2^j\cdot-k):p,j,\in\mathbb N_0,k\in\mathbb Z\big\}
\end{equation}
of $L_2(\mathbb R)$-normalized functions. Note that besides from the truncated and shifted Legendre polynomials, $\Psi$ also contains the orthonormal Haar wavelet basis
\begin{equation*}
\big\{\varphi_0(\cdot -k):k\in\mathbb Z\big\}\cup\big\{\psi_{0,j,k}=2^{j/2}\psi_0(2^j\cdot-k):j\in\mathbb N_0,k\in\mathbb Z\big\}.
\end{equation*}
In Figure \ref{fig:quarklets}, we see some plots of the Legendre-Haar quarks and quarklets.

\begin{figure}[hbt]
\centering
\begin{tikzpicture}
  \matrix[matrix of nodes,nodes=img, column sep=2mm]{
    $\varphi_p$ &
    \ing{p0_j0_e0_k0} &
    \ing{p1_j0_e0_k0} &
    \ing{p2_j0_e0_k0} &
    \ing{p3_j0_e0_k0} &
    \ing{p4_j0_e0_k0} \\
    $\psi_{p,0,0}$ &
    \ing{p0_j0_e1_k0} &
    \ing{p1_j0_e1_k0} &
    \ing{p2_j0_e1_k0} &
    \ing{p3_j0_e1_k0} &
    \ing{p4_j0_e1_k0} \\
    $\psi_{p,1,0}$ &
    \ing{p0_j1_e1_k0} &
    \ing{p1_j1_e1_k0} &
    \ing{p2_j1_e1_k0} &
    \ing{p3_j1_e1_k0} &
    \ing{p4_j1_e1_k0} \\
    $\psi_{p,1,1}$ &
    \ing{p0_j1_e1_k1} &
    \ing{p1_j1_e1_k1} &
    \ing{p2_j1_e1_k1} &
    \ing{p3_j1_e1_k1} &
    \ing{p4_j1_e1_k1} \\
  };
\end{tikzpicture}
\caption{\label{fig:quarklets} Some Legendre-Haar quarks $\varphi_p$ and quarklets $\psi_{p,j,k}$ with $0\le p\le 4$}
\end{figure}

\subsection{Orthogonality properties between quarks and quarklets}
We will now collect the orthogonality properties of various subsets of the Legendre-Haar quarklet system $\Psi$ from \eqref{eq:Psi}. The following lemma covers the case $j=0$.
\begin{lemma}\label{lemma:ortholemma1}
We have
\begin{equation}
  \label{eq:phipphiqorth}
  \big\langle\varphi_p,\varphi_q(\cdot-k)\big\rangle_{L_2(\mathds R)}=\begin{cases}
  1,&k=0\text{ and }p=q\\
  0,&\text{otherwise}
  \end{cases},\quad
  p,q\in\mathbb N_0,\quad k\in\mathbb Z.
\end{equation}
Moreover, we have
\begin{equation}
  \label{eq:phipproducts}
  \big\langle\varphi_p(2\cdot-k),\varphi_p\big\rangle_{L_2(\mathbb R)}
  =
  \begin{cases}
  2^{-(p+1)},&\;k\in\{0,1\}\\
  0,&\;\text{otherwise}
  \end{cases},
  \quad
  p\in\mathbb N_0,\quad k\in\mathbb Z.
\end{equation}
By consequence, Legendre-Haar quarklets are orthogonal to Legendre-Haar quarks of the same or of lower degree,
\begin{equation}
  \label{eq:psipphiqorth}
  \big\langle\psi_p,\varphi_q(\cdot-k)\big\rangle_{L_2(\mathbb R)}=0,
  \quad
  \text{for all } 0\le q\le p,\quad k\in\mathbb Z.
\end{equation}
In particular, each $\psi_p$ has $p+1$ vanishing moments,
$\langle\psi_p,r\rangle_{L_2(\mathbb R)}=0$ for all $r\in\mathbb P_p$.
Moreover, Legendre-Haar quarklets are orthogonal to Legendre-Haar quarklets of lower degree,
\begin{equation}
  \label{eq:psippsiqorth}
  \big\langle\psi_p,\psi_q(\cdot-k)\big\rangle_{L_2(\mathbb R)}=
  \begin{cases}
  1,&k=0\text{ and }p=q,\\
  0,&\text{otherwise}
  \end{cases},\quad
  \text{for all } 0\le q\le p,\quad k\in\mathbb Z.
\end{equation}
\end{lemma}
\begin{proof}
  \eqref{eq:phipphiqorth} follows from $\supp\varphi_p=[0,1]$ and from the orthonormality of the truncated, shifted and renormalized Legendre polynomials. As concerns \eqref{eq:phipproducts}, let $k\in\{0,1\}$. On $\supp\varphi_p(2\cdot-k)=[\frac{k}{2},\frac{k+1}{2}]$,
  $\varphi_p$ is a polynomial of degree $p$ the leading
  coefficient of which coincides with $2^{-p}$ times the leading coefficient of $\varphi_p(2\cdot-k)$.
  Since $\varphi_p(2\cdot-k)$ is orthogonal to all polynomials of degree $p-1$ on its support,
  it follows
  \begin{equation*}
    \big\langle\varphi_p(2\cdot-k),\varphi_p\big\rangle_{L_2(\mathbb R)}
    =
    2^{-p}\big\langle\varphi_p(2\cdot-k),2^p\varphi_p\big\rangle_{L_2(\mathbb R)}
    =
    2^{-p}\big\|\varphi_p(2\cdot-k)\|_{L_2(\mathbb R)}^2
    =
    2^{-(p+1)}.
  \end{equation*}
  If $k\notin\{0,1\}$, the supports of $\varphi_p(2\cdot-k)$ and $\varphi_p$
  are disjoint, hence \eqref{eq:phipproducts} follows.
  Combining \eqref{eq:psip} with \eqref{eq:phipproducts},
  we compute for $0\le q\le p$ and any $k\in\mathbb Z$ that
  \begin{align*}
    \big\langle\psi_p,\varphi_q(\cdot-k)\big\rangle_{L_2(\mathbb R)}
    &=
    \big\langle\varphi_p(2\cdot+2k)-\varphi_p(2\cdot+2k-1),\varphi_q\big\rangle_{L_2(\mathbb R)}
    =0,
  \end{align*}
  which yields \eqref{eq:psipphiqorth} and, in turn, the vanishing moment property
  $\psi_p\perp\mathbb P_p$. Finally, \eqref{eq:psippsiqorth} follows from \eqref{eq:phipphiqorth} after inserting the definition of $\psi_p$,
  \begin{align*}
  \big\langle\psi_p,\psi_q(\cdot-k)\big\rangle_{L_2(\mathbb R)}
  &=
  \big\langle\varphi_p(2\cdot)-\varphi_p(2\cdot-1),\varphi_q(2\cdot-2k)-\varphi_q(2\cdot-2k-1)\big\rangle_{L_2(\mathbb R)}\\
  &=
  \big\langle\varphi_p(2\cdot),\varphi_q(2\cdot-2k)-\varphi_q(2\cdot-2k-1)\big\rangle_{L_2(\mathbb R)}\\
  &\phantom{=}
  -\big\langle\varphi_p(2\cdot-1),\varphi_q(2\cdot-2k)-\varphi_q(2\cdot-2k-1)\big\rangle_{L_2(\mathbb R)}\\
  &=
  \begin{cases}
  1,&k=0\text{ and }p=q,\\
  0,&\text{otherwise}
  \end{cases},\quad 0\le q\le p,\quad k\in\mathbb Z.
  \end{align*}
\end{proof}

As concerns the orthogonality properties between dilated quarks and quarklets, the situation is more complicated because low-degree, fine-scale quark(let)s are in general \emph{not} orthogonal to high-degree, low-scale quark(lets). In the following lemma, we collect some positive results on orthogonality between individual elements of the quarklet system $\Psi$.
\begin{lemma}
Let $p,p',j,j'\ge 0$ and $k\in\mathbb Z$. Then the following implications hold true:
\begin{equation}\label{eq:phippsippjpkporthocond}
p'\ge p\quad\Rightarrow\quad
\langle\varphi_p,\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}=0,
\end{equation}
\begin{equation}\label{eq:psipjkpsippjpkporthocond}
\left.\begin{aligned}
p'\ge p\wedge j'>j\\
\text{or }p'>p\wedge j'\ge j\\
\text{or } \meas(2^{-j}[k,k+1]\cap 2^{-j}[k',k'+1])=0
\end{aligned}\right\}
\quad\Rightarrow\quad
\langle\psi_{p,j,k},\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}=0.
\end{equation}
\end{lemma}
\begin{proof}
If $p'\ge p$, then $\varphi_p$ is a polynomial of degree at most $p\le p'$ on the support of $\psi_{p',j',k'}$, so that \eqref{eq:psipphiqorth} yields $\langle\varphi_p,\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}=0$, showing \eqref{eq:phippsippjpkporthocond}.

Similarly, if $j'>j$ and $p'\ge p$, then $\psi_{p,j,k}$ is a polynomial of degree at most $p\le p'$ on the support of $\psi_{p',j',k'}$, so that \eqref{eq:psipphiqorth} yields  $\langle\psi_{p,j,k},\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}=0$, showing the first implication in \eqref{eq:psipjkpsippjpkporthocond}.

If $p'>p$ and $j'\ge j$, we can insert the definition \eqref{eq:Psi} of the quarklets $\psi_{p,j,k}$ and obtain
\begin{align*}
\lefteqn{\langle \psi_{p,j,k},\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}}\\
&=
2^{(j+j')/2}\big\langle\varphi_p(2^{j+1}\cdot-2k)-\varphi_p(2^{j+1}\cdot-2k-1),\varphi_{p'}(2^{j'+1}\cdot-2k')-\varphi_{p'}(2^{j'+1}\cdot-2k'-1)\big\rangle_{L_2(\mathbb R)}\\
&=
2^{(j-j')/2-1}\big\langle\varphi_p(2^{j-j'}\cdot-2k)-\varphi_p(2^{j-j'}\cdot-2k-1),\varphi_{p'}(\cdot-2k')-\varphi_{p'}(\cdot-2k'-1)\big\rangle_{L_2(\mathbb R)}.
\end{align*}
In view of $p<p'$ and $j\le j'$, the function $\varphi_p(2^{j-j'}\cdot-2k)-\varphi_p(2^{j-j'}\cdot-2k-1)$ is a polynomial of degree at most $p$ on the respective supports of $\varphi_{p'}(\cdot-2k')$ and $\varphi_{p'}(\cdot-2k'-1)$, so that $\langle\psi_{p,j,k},\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}$ vanishes, showing the second implication in \eqref{eq:phippsippjpkporthocond}.

Finally, if $\meas(2^{-j}[k,k+1]\cap 2^{-j'}[k',k'+1])=0$, the support sets of $\psi_{p,j,k}$ and $\psi_{p',j',k'}$ do at most touch, so that $\langle\psi_{p,j,k},\psi_{p',j',k'}\rangle_{L_2(\mathbb R)}=0$, and the proof is complete.
\end{proof}

\end{document}
